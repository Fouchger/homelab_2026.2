---
# -----------------------------------------------------------------------------
# Filename: ansible/site.yml
# Created: 2026-01-18
# Updated: 2026-01-19
# Description: Top-level Ansible playbook for homelab_2026.2.
# Developer notes:
#   - Keep playbooks small; prefer roles.
#   - Inventory groups are defined in inventories/.
# -----------------------------------------------------------------------------

- name: Baseline configuration for all hosts
  hosts: all
  become: true
  roles:
    - common

- name: Admin node
  hosts: admin
  become: true
  roles:
    - admin_node
    - vaultwarden
    - role: mikrotik_integration
      when: homelab_mikrotik_host is defined and (homelab_mikrotik_host | length) > 0

- name: DNS server
  hosts: dns
  become: true
  roles:
    - dns_server

- name: DHCP server
  hosts: dhcp
  become: true
  roles:
    - role: dhcp_server
      when: homelab_dhcp_mode | default('mikrotik') == 'proxmox'
